<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SearchFilmBot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<!-- Навігаційна панель -->
<div class="navbar">
    <a href="#" class="navbar-item" onclick="openTab(event, 'films')">Фільми</a>
    <a href="#" class="navbar-item" onclick="openTab(event, 'series')">Серіали</a>
    <a href="#" class="navbar-item" onclick="openTab(event, 'anime')">Аніме</a>
    <a href="#" class="navbar-item" onclick="openTab(event, 'manga')">Манга</a>

    <form action="/api/search" method="get" class="search-bar">
        <input type="text" placeholder="Пошук.." name="q" class="search-input">
        <input type="hidden" name="tab" id="activeTabInput" value="films">
        <button type="submit">Пошук</button>
    </form>

    <a href="#" class="navbar-item account" id="loginLink">Вхід
        <img src="{{ url_for('static', filename='Images/account-icon.png') }}" alt="Іконка акаунта" class="account-icon">
    </a>
</div>

<!-- Повідомлення про помилку -->
{% if error %}
<div class="error-message">
    <p>{{ error }}</p>
</div>
{% endif %}

<!-- Контейнер для вкладок -->
<div id="films" class="tab-content" {% if active_tab != 'films' %}style="display:none;"{% endif %}>
    <h2>Фільми</h2>
    <div id="films-list">
        {% if search_results %}
            {% for result in search_results %}
                <div class="film-item">
                    <h3>{{ result['name'] }}</h3>
                </div>
            {% endfor %}
        {% else %}
            <p>{% if not error %}Нічого не знайдено.{% endif %}</p>
        {% endif %}
    </div>
</div>

<div id="series" class="tab-content" {% if active_tab != 'series' %}style="display:none;"{% endif %}>
    <h2>Серіали</h2>
    <div id="series-list">
        {% if search_results %}
            {% for result in search_results %}
                <div class="series-item">
                    <h3>{{ result['name'] }}</h3>
                </div>
            {% endfor %}
        {% else %}
            <p>{% if not error %}Нічого не знайдено.{% endif %}</p>
        {% endif %}
    </div>
</div>

<div id="anime" class="tab-content" {% if active_tab != 'anime' %}style="display:none;"{% endif %}>
    <h2>Аніме</h2>
    <div id="anime-list">
        {% if search_results %}
            {% for result in search_results %}
                <div class="anime-item">
                    <h3>{{ result['name'] }}</h3>
                </div>
            {% endfor %}
        {% else %}
            <p>{% if not error %}Нічого не знайдено.{% endif %}</p>
        {% endif %}
    </div>
</div>

<div id="manga" class="tab-content" {% if active_tab != 'manga' %}style="display:none;"{% endif %}>
    <h2>Манга</h2>
    <div id="manga-list">
        {% if search_results %}
            {% for result in search_results %}
                <div class="manga-item">
                    <h3>{{ result['name'] }}</h3>
                </div>
            {% endfor %}
        {% else %}
            <p>{% if not error %}Нічого не знайдено.{% endif %}</p>
        {% endif %}
    </div>
</div>


<!-- Модальне вікно для авторизації -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>Вхід в акаунт</h2>
        <form action="#" method="post">
            <label for="username">Username</label>
            <input type="text" id="username" name="username" required>
            <label for="password">Password</label>
            <input type="password" id="password" name="password" required>
            <button type="submit" class="login-button">Увійти</button>
        </form>
    </div>
</div>

<!-- JavaScript для вкладок і модального вікна -->
<script>
 function openTab(event, tabId) {
        // Сховати всі вкладки
        const tabContents = document.querySelectorAll(".tab-content");
        tabContents.forEach(content => content.style.display = "none");

        // Видалити активний стан у навігації
        const navbarItems = document.querySelectorAll(".navbar-item");
        navbarItems.forEach(item => item.classList.remove("active"));

        // Відобразити вибрану вкладку та додати активний стан
        document.getElementById(tabId).style.display = "block";
        event.currentTarget.classList.add("active");

        // Змінити активну вкладку в прихованому полі форми
        document.getElementById("activeTabInput").value = tabId;
    }

    // Встановити початкову вкладку
    const activeTab = "{{ active_tab }}";
    if (activeTab) {
        document.querySelector(`.navbar-item[onclick="openTab(event, '${activeTab}')"]`).click();
    }
    

    // Відкриває модальне вікно при натисканні на "Акаунт"
    document.querySelector('#loginLink').onclick = function(event) {
        event.preventDefault();
        document.getElementById('loginModal').style.display = 'flex';
    }

    // Закриває модальне вікно
    function closeModal() {
        document.getElementById('loginModal').style.display = 'none';
    }

    // Закриває модальне вікно при натисканні поза його межами
    window.onclick = function(event) {
        const modal = document.getElementById('loginModal');
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    }

    // Показуємо першу вкладку за замовчуванням
    //document.getElementById("films").style.display = "block";
</script>

</body>
</html>
